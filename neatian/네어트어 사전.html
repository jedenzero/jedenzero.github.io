<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8">
	  <meta http-equiv="X-UA-Compatible" content="IE=edge">
	  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	  <title>네어트어</title>
      <link rel="stylesheet" href="../grayblue.css">
  </head>
  <body>
    <div class="header">
      <a style="margin-left:20px;color:#1D2F52;font-size:15px;" href="https://jedenzero.github.io/neatian/">NEĂTĂK</a>
    </div>
    <div class="contain" style="width:260px;">
    <div class="underline">
      <input type="text" id="search" onkeyup="search()">
    </div>
    <div id="output"></div>
    </div>
  </body>
  <script>
    const input = document.getElementById('search');
    const resultDiv = document.getElementById('output');
    
    function search() {
      const keyword = input.value;

      fetch('https://sheets.googleapis.com/v4/spreadsheets/13LICoyhYt4Do9R24ktfoDpSDFxhHKpO-r44P3ROTJZQ/values/ne!A:C?key=AIzaSyATLeHQh6kM0LWRJjLg8CmzoSdnntFrmFk')
      .then(response => response.json())
      .then(data => {
        let Match = data.values.filter(row=>row[0].includes(keyword));
        let exactMatch = data.values.filter(row=>row[0]===(keyword));
        let startMatch = data.values.filter(row=>row[0].startsWith(keyword)&&row[0]!==keyword);
        let otherMatch = data.values.filter(row=>!exactMatch.includes(row)&&!startMatch.includes(row));

        output.innerHTML = '';
        
        exactMatch.forEach((row, index)=>createWordElement(index+1,row));
        startMatch.forEach ((row, index)=>createWordElement(index+1+exactMatch.length,row));
        otherMatch.forEach((row, index)=>createWordElement(index+1+exactMatch.length+startMatch.length,row);
        
        function createWordElement(id,data) {
          const div=document.createElement('div');
          div.className='word';
          div.innerHTML+='<sup>'+id+'</sup>'+'<h2 style="display:inline-block;">'+data[0]+'</h2>';
          div.innerHTML+='<p>('+data[1]+') ';
          div.innerHTML+=data[2]+'</p>';
          output.appendChild (div);
         }
      })
      .catch(error => console.error('Error:', error));
    };
  </script>
</html>
