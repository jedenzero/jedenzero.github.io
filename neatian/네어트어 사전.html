<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8">
	  <meta http-equiv="X-UA-Compatible" content="IE=edge">
	  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	  <title>네어트어</title>
      <link rel="stylesheet" href="../grayblue.css">
  </head>
  <body>
    <div class="header">
      <a style="margin-left:20px;color:#1D2F52;font-size:15px;" href="https://jedenzero.github.io/neatian/">NEĂTĂK</a>
    </div>
    <div class="contain" style="width:260px;">
    <p id="total_amount"></p>
    <div class="underline">
      <input type="text" id="search" onkeyup="search()">
    </div>
    <div class="limit" onclick="limit()">명사</div>
    <div class="limit" onclick="limit()">동사</div>
    <div class="limit" onclick="limit()">조사</div>
    <div class="limit" onclick="limit()">부사</div>
    <div class="limit" onclick="limit()">접속사</div>
    <div class="limit" onclick="limit()">전접사</div>
    <div class="limit" onclick="limit()">후접사</div>
    <div class="limit" onclick="limit()">접두사</div>
    <div class="limit" onclick="limit()">접미사</div>
    <p id="search_amount"></p>
    <div id="output"></div>
    </div>
  </body>
  <script>
    const input = document.getElementById('search');
    const output = document.getElementById('output');
    const totalAmount = document.getElementById('total_amount');
    const searchAmount = document.getElementById('search_amount');
    const limitare = [];
    
    function search() {
      const keyword = input.value;

      fetch('https://sheets.googleapis.com/v4/spreadsheets/13LICoyhYt4Do9R24ktfoDpSDFxhHKpO-r44P3ROTJZQ/values/ne!A:C?key=AIzaSyATLeHQh6kM0LWRJjLg8CmzoSdnntFrmFk')
      .then(response => response.json())
      .then(data => {
        let Match = data.values.filter(row=>row[0].includes(keyword)||row[2].includes(keyword));
        Match = Match.filter(row=>!limitarr.includes(row[1]));
        
        let exactMatch = Match.filter(row=>row[0]===(keyword)||row[2].split(', ').includes(keyword));
        let startMatch = Match.filter(row=>row[0].startsWith(keyword)&&row[0]!==keyword);
        let otherMatch = Match.filter(row=>!exactMatch.includes(row)&&!startMatch.includes(row));

        totalAmount.innerHTML = '현재 총 단어수 : '+data.values.length+'개'
        searchAmount.innerHTML = '검색 결과 : '+Match.length+'개'
        output.innerHTML = '';
        
        exactMatch.forEach((row, index)=>createWordElement(index+1,row));
        startMatch.forEach ((row, index)=>createWordElement(index+1+exactMatch.length,row));
        otherMatch.forEach((row, index)=>createWordElement(index+1+exactMatch.length+startMatch.length,row));
        
        function createWordElement(id,data) {
          const div=document.createElement('div');
          div.className='word';
          div.innerHTML+='<sup>'+id+'</sup>'+'<h2 style="display:inline-block;margin-bottom:0;"><b>'+data[0]+'</b></h2>';
          div.innerHTML+='<p>'+data[1]+'<br>';
          div.innerHTML+=data[2]+'</p>';
          output.appendChild (div);
         }
      })
      .catch(error => console.error('Error:', error));
    };
    function limit(){
      if (this.style.backgroundColor!=="#F5F5F5"){
        this.style.backgroundColor="#F5F5F5";
        this.style.color="#374052";
        limitarr.push(this.innerText);
      }
      else{
        this.style.backgroundColor="#1D2F52";
        this.style.color="#F5F5F5";
        limitarr.splice(limitarr.indexOf(this.innerText),1);
      }
    }
    search();
  </script>
</html>
